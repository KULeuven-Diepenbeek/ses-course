<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.81.0" />
    <meta name="description" content="">


    <link rel="icon" href="../images/favicon.png" type="image/png">

    <title>3. Test Driven Development :: Software Engineering Skills</title>

    
    <link href="../css/nucleus.css?1686665213" rel="stylesheet">
    <link href="../css/fontawesome-all.min.css?1686665213" rel="stylesheet">
    <link href="../css/hybrid.css?1686665213" rel="stylesheet">
    <link href="../css/featherlight.min.css?1686665213" rel="stylesheet">
    <link href="../css/perfect-scrollbar.min.css?1686665213" rel="stylesheet">
    <link href="../css/auto-complete.css?1686665213" rel="stylesheet">
    <link href="../css/atom-one-dark-reasonable.css?1686665213" rel="stylesheet">
    <link href="../css/theme.css?1686665213" rel="stylesheet">
    <link href="../css/devselector.css?1686665213" rel="stylesheet">
    <link href="../css/hugo-theme.css?1686665213" rel="stylesheet">
    <link href="../css/theme-kul.css?1686665213" rel="stylesheet">
    

    <script src="../js/jquery-3.3.1.min.js?1686665213"></script>
    <script src="../js/devselector.js?1686665213"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
        :not(pre) > code + span.copy-to-clipboard {
            display: none;
        }
      
    </style>
    
  </head>
  <body class="" data-url="../tdd/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a href="https://www.kuleuven.be/kuleuven/" target="_blank">
  <img src="../images/kul.png" alt="KU Leuven" /><br/>
</a>
<a href="https://www.uhasselt.be/" target="_blank">
  <img src="../images/uhasselt.svg" alt="UHasselt" id="uhlogo" />
</a>
    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="../js/lunr.min.js?1686665213"></script>
<script type="text/javascript" src="../js/auto-complete.js?1686665213"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/kuleuven-diepenbeek.github.io\/ses-course\/";
    
</script>
<script type="text/javascript" src="../js/search.js?1686665213"></script>

    
  </div>

    <div class="highlightable">

      <h3><a href="../">Course Contents</a></h3>
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/versiebeheer/" title="1. Versie- en issuebeheer" class="dd-item
        
        
        
        ">
      <a href="../versiebeheer/">
          1. Versie- en issuebeheer
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/dependency-management/" title="2. Dependency Management" class="dd-item
        
        
        
        ">
      <a href="../dependency-management/">
          2. Dependency Management
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/dependency-management/cmdline/" title="2.1 Cmdline Java Compiling" class="dd-item ">
        <a href="../dependency-management/cmdline/">
        2.1 Cmdline Java Compiling
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/dependency-management/gradle/" title="2.2 Java Gradle projecten" class="dd-item ">
        <a href="../dependency-management/gradle/">
        2.2 Java Gradle projecten
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/dependency-management/kotlin-gradle/" title="2.3 Kotlin Gradle projecten" class="dd-item ">
        <a href="../dependency-management/kotlin-gradle/">
        2.3 Kotlin Gradle projecten
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/tdd/" title="3. Test Driven Development" class="dd-item
        parent
        active
        
        ">
      <a href="../tdd/">
          3. Test Driven Development
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/tdd/in-de-praktijk/" title="3.1 TDD In de praktijk" class="dd-item ">
        <a href="../tdd/in-de-praktijk/">
        3.1 TDD In de praktijk
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/tdd/capita/" title="3.2 TDD Capita Selecta: Algoritmes" class="dd-item ">
        <a href="../tdd/capita/">
        3.2 TDD Capita Selecta: Algoritmes
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/algoritmes/" title="4. Algoritmes en Datastructuren" class="dd-item
        
        
        
        ">
      <a href="../algoritmes/">
          4. Algoritmes en Datastructuren
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/patterns/" title="5. Design Patterns" class="dd-item
        
        
        
        ">
      <a href="../patterns/">
          5. Design Patterns
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/patterns/facade/" title="5.1 Facade" class="dd-item ">
        <a href="../patterns/facade/">
        5.1 Facade
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/patterns/di/" title="5.2 Dependency Injection" class="dd-item ">
        <a href="../patterns/di/">
        5.2 Dependency Injection
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/patterns/singleton/" title="5.3 Singleton" class="dd-item ">
        <a href="../patterns/singleton/">
        5.3 Singleton
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/patterns/decorator/" title="5.4 Decorator" class="dd-item ">
        <a href="../patterns/decorator/">
        5.4 Decorator
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/patterns/factory/" title="5.5 Factory" class="dd-item ">
        <a href="../patterns/factory/">
        5.5 Factory
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/patterns/catching-patterns-in-the-wild/" title="5.6 Catching Patterns in the Wild" class="dd-item ">
        <a href="../patterns/catching-patterns-in-the-wild/">
        5.6 Catching Patterns in the Wild
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/lifecycle/" title="6. Software Management" class="dd-item
        
        
        
        ">
      <a href="../lifecycle/">
          6. Software Management
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/lifecycle/ci/" title="6.1 Continuous Integration &amp; Deployment" class="dd-item ">
        <a href="../lifecycle/ci/">
        6.1 Continuous Integration &amp; Deployment
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/lifecycle/management/" title="6.2 Software Management Skills" class="dd-item ">
        <a href="../lifecycle/management/">
        6.2 Software Management Skills
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/extra/" title="Extra informatie" class="dd-item
        
        
        
        ">
      <a href="../extra/">
          Extra informatie
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/extra/software/" title="Gebruikte Software" class="dd-item ">
        <a href="../extra/software/">
        Gebruikte Software
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/extra/sessy/" title="SESsy Library (1) De WebApp" class="dd-item ">
        <a href="../extra/sessy/">
        SESsy Library (1) De WebApp
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/extra/sessy-extending/" title="SESsy Library (2) Uitbreidingen" class="dd-item ">
        <a href="../extra/sessy-extending/">
        SESsy Library (2) Uitbreidingen
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/extra/taak-oss-feedback/" title="Taak 1 OSS Contrib.: Feedback" class="dd-item ">
        <a href="../extra/taak-oss-feedback/">
        Taak 1 OSS Contrib.: Feedback
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/extra/taak-oss/" title="Taak 1: Open Source Contributie" class="dd-item ">
        <a href="../extra/taak-oss/">
        Taak 1: Open Source Contributie
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
        
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li>
                  <a class="padding" href="https://uhintra03.uhasselt.be/studiegidswww/opleidingsonderdeel.aspx?a=2022&amp;i=4083&amp;n=4&amp;t=01"><i class='fa fa-university'></i> ECTS Sheet</a>
              </li>
          
              <li>
                  <a class="padding" href="https://toledo.kuleuven.be/portal/"><i class='fa fa-university'></i> Toledo</a>
              </li>
          
              <li>
                  <a class="padding" href="https://github.com/kuleuven-diepenbeek/ses-course/"><i class='fab fa-github'></i> Course Git Repository</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            <a href='../'>Software Engineering Skills</a> > 3. Test Driven Development
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#test-driven-development">Test-Driven Development</a>
      <ul>
        <li><a href="#een-tdd-scenario">Een TDD Scenario</a></li>
      </ul>
    </li>
    <li><a href="#unit-testing-basics">Unit Testing Basics</a>
      <ul>
        <li><a href="#wat-is-unit-testing">Wat is Unit Testing</a></li>
        <li><a href="#het-raamwerk-van-een-test">Het Raamwerk van een test</a></li>
        <li><a href="#soorten-van-testen">Soorten van Testen</a></li>
      </ul>
    </li>
    <li><a href="#a-nameoefalabo-oefeningen"><a name="oef"></a>Labo oefeningen</a>
      <ul>
        <li><a href="#opgave-1">Opgave 1</a></li>
        <li><a href="#opgave-2">Opgave 2</a></li>
        <li><a href="#opgave-3">Opgave 3</a></li>
        <li><a href="#opgave-4">Opgave 4</a></li>
        <li><a href="#unit-testen">Unit testen</a></li>
        <li><a href="#hoe-controleer-ik-het-gedrag-van-de-fabriek">Hoe controleer ik het gedrag van de fabriek?</a></li>
        <li><a href="#opgave-5">Opgave 5</a></li>
      </ul>
    </li>
    <li><a href="#denkvragen">Denkvragen</a></li>
    <li><a href="#extra-leermateriaal">Extra leermateriaal</a></li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              3. Test Driven Development
            </h1>
          

        



	<blockquote>
<p><i class="fa fa-question-circle" aria-hidden="true"></i>
Wat is de beste manier om het aantal bugs in code te reduceren?</p>
</blockquote>
<h2 id="test-driven-development">Test-Driven Development</h2>
<p>TDD (Test-Driven Development) is een hulpmiddel bij softwareontwikkeling om minder fouten te maken en sneller fouten te vinden, door éérst een test te schrijven en dan pas de implementatie. Die (unit) test zal dus eerst <strong>falen</strong> (ROOD), want er is nog helemaal geen code, en na de correcte implementatie uiteindelijk <strong>slagen</strong> (GROEN).</p>
<script defer src="../mermaid/mermaid.min.js">
	mermaid.initialize({
		startOnLoad: true,
		flowchart: {
			useMaxWidth: true
		}
	});
</script>
<div class="mermaid" align="center" >
	
graph LR;
    T{"Write FAILING<br/> test"}
    D{"Write<br/> IMPLEMENTATION"}
    C{"Run test<br/> SUCCEEDS"}
    S["Start Hier"]
    S --> T
    T --> D
    D --> C
    C --> T

</div>
<p>Testen worden in opgenomen in een build omgeving, waardoor alle testen automatisch worden gecontroleerd bij bijvoorbeeld het compileren, starten, of packagen van de applicatie. Op deze manier krijgt men <strong>onmiddellijk feedback</strong> van modules die door bepaalde wijzigingen niet meer werken zoals beschreven in de test.</p>
<h3 id="een-tdd-scenario">Een TDD Scenario</h3>
<p>Stel dat een programma een notie van periodes nodig heeft, waarvan elke periode een start- en einddatum heeft, die al dan niet ingevuld kunnen zijn. Een contract bijvoorbeeld geldt voor een periode van <em>bepaalde duur</em>, waarvan beide data ingevuld zijn, of voor gelukkige werknemers voor een periode van <em>onbepaalde duur</em>, waarvan de einddatum ontbreekt:</p>
<div class="devselect">
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kt" data-lang="kt"><span style="color:#00a8c8">class</span> <span style="color:#75af00">Contract</span><span style="color:#111">()</span> <span style="color:#111">{</span>
    <span style="color:#00a8c8">private</span> <span style="color:#00a8c8">lateinit</span> <span style="color:#111">periode</span><span style="color:#111">:</span> <span style="color:#111">Periode</span>
<span style="color:#111">}</span>

<span style="color:#00a8c8">data</span> <span style="color:#00a8c8">class</span> <span style="color:#75af00">Periode</span><span style="color:#111">(</span><span style="color:#00a8c8">val</span> <span style="color:#111">startDatum</span><span style="color:#111">:</span> <span style="color:#111">LocalDate</span><span style="color:#111">,</span> <span style="color:#00a8c8">val</span> <span style="color:#111">eindDatum</span><span style="color:#111">:</span> <span style="color:#111">LocalDate</span><span style="color:#111">)</span>
</code></pre></div><div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#00a8c8">public</span> <span style="color:#00a8c8">class</span> <span style="color:#75af00">Contract</span> <span style="color:#f92672">{</span>
    <span style="color:#00a8c8">private</span> <span style="color:#111">Periode</span> <span style="color:#111">periode</span><span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>

<span style="color:#00a8c8">public</span> <span style="color:#00a8c8">class</span> <span style="color:#75af00">Periode</span> <span style="color:#f92672">{</span>
    <span style="color:#00a8c8">private</span> <span style="color:#111">Date</span> <span style="color:#111">startDatum</span><span style="color:#f92672">;</span>
    <span style="color:#00a8c8">private</span> <span style="color:#111">Date</span> <span style="color:#111">eindDatum</span><span style="color:#f92672">;</span> 
<span style="color:#f92672">}</span>
</code></pre></div></div>
<p>We wensen aan de <code>Periode</code> klasse een methode toe te voegen om te controleren of periodes overlappen, zodat de volgende statement mogelijk is: <code>periode1.overlaptMet(periode2)</code>.</p>
<h4 id="1-schrijf-falende-testen">1. Schrijf Falende Testen</h4>
<p>Voordat de methode wordt opgevuld met een implementatie dienen we na te denken over de mogelijke gevallen van een periode. Wat kan overlappen met wat? Wanneer geeft de methode <code>true</code> terug, en wanneer <code>false</code>? Wat met lege waardes?</p>
<ul>
<li>Het standaard geval: beide periodes hebben start- en einddatum ingevuld, en de periodes overlappen.</li>
</ul>
<div class="devselect">
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kt" data-lang="kt"><span style="color:#75af00">@Test</span>
<span style="color:#00a8c8">fun</span> <span style="color:#75af00">`Gegeven biede periodes met datum ingevuld Wanneer overlaptMet Dan is true`</span><span style="color:#111">()</span> <span style="color:#111">{</span>
    <span style="color:#00a8c8">val</span> <span style="color:#111">jandec19</span> <span style="color:#111">=</span> <span style="color:#111">Periode</span><span style="color:#111">(</span><span style="color:#111">LocalDate</span><span style="color:#111">.</span><span style="color:#111">of</span><span style="color:#111">(</span><span style="color:#ae81ff">2019</span><span style="color:#111">,</span> <span style="color:#ae81ff">1</span><span style="color:#111">,</span> <span style="color:#ae81ff">1</span><span style="color:#111">),</span>
        <span style="color:#111">LocalDate</span><span style="color:#111">.</span><span style="color:#111">of</span><span style="color:#111">(</span><span style="color:#ae81ff">2019</span><span style="color:#111">,</span> <span style="color:#ae81ff">12</span><span style="color:#111">,</span> <span style="color:#ae81ff">31</span><span style="color:#111">))</span>
    <span style="color:#00a8c8">val</span> <span style="color:#111">maartnov19</span> <span style="color:#111">=</span> <span style="color:#111">Periode</span><span style="color:#111">(</span><span style="color:#111">LocalDate</span><span style="color:#111">.</span><span style="color:#111">of</span><span style="color:#111">(</span><span style="color:#ae81ff">2019</span><span style="color:#111">,</span> <span style="color:#ae81ff">3</span><span style="color:#111">,</span> <span style="color:#ae81ff">1</span><span style="color:#111">),</span>
        <span style="color:#111">LocalDate</span><span style="color:#111">.</span><span style="color:#111">of</span><span style="color:#111">(</span><span style="color:#ae81ff">2019</span><span style="color:#111">,</span> <span style="color:#ae81ff">11</span><span style="color:#111">,</span> <span style="color:#ae81ff">31</span><span style="color:#111">))</span>

    <span style="color:#111">assertTrue</span> <span style="color:#111">{</span> <span style="color:#111">jandec19</span><span style="color:#111">.</span><span style="color:#111">overlaptMet</span><span style="color:#111">(</span><span style="color:#111">maartnov19</span><span style="color:#111">)</span> <span style="color:#111">}</span>
<span style="color:#111">}</span>
</code></pre></div><div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75af00">@Test</span>
<span style="color:#00a8c8">public</span> <span style="color:#00a8c8">void</span> <span style="color:#75af00">GegevenBeidePeriodesDatumIngevuld_Wanneeroverlapt_DanIsTrue</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
    <span style="color:#111">var</span> <span style="color:#111">jandec19</span> <span style="color:#f92672">=</span> <span style="color:#00a8c8">new</span> <span style="color:#111">Periode</span><span style="color:#f92672">(</span><span style="color:#00a8c8">new</span> <span style="color:#111">Date</span><span style="color:#f92672">(</span><span style="color:#111">2019</span><span style="color:#f92672">,</span> <span style="color:#111">01</span><span style="color:#f92672">,</span> <span style="color:#111">01</span><span style="color:#f92672">),</span> 
            <span style="color:#00a8c8">new</span> <span style="color:#111">Date</span><span style="color:#f92672">(</span><span style="color:#111">2019</span><span style="color:#f92672">,</span> <span style="color:#111">12</span><span style="color:#f92672">,</span> <span style="color:#111">31</span><span style="color:#f92672">));</span>
    <span style="color:#111">var</span> <span style="color:#111">maartnov19</span> <span style="color:#f92672">=</span> <span style="color:#00a8c8">new</span> <span style="color:#111">Periode</span><span style="color:#f92672">(</span><span style="color:#00a8c8">new</span> <span style="color:#111">Date</span><span style="color:#f92672">(</span><span style="color:#111">2019</span><span style="color:#f92672">,</span> <span style="color:#111">03</span><span style="color:#f92672">,</span> <span style="color:#111">01</span><span style="color:#f92672">),</span>
            <span style="color:#00a8c8">new</span> <span style="color:#111">Date</span><span style="color:#f92672">(</span><span style="color:#111">2019</span><span style="color:#f92672">,</span> <span style="color:#111">11</span><span style="color:#f92672">,</span> <span style="color:#111">31</span><span style="color:#f92672">));</span>

    <span style="color:#111">assertThat</span><span style="color:#f92672">(</span><span style="color:#111">jandec19</span><span style="color:#f92672">.</span><span style="color:#75af00">overlaptMet</span><span style="color:#f92672">(</span><span style="color:#111">maartnov19</span><span style="color:#f92672">),</span> <span style="color:#111">is</span><span style="color:#f92672">(</span><span style="color:#00a8c8">true</span><span style="color:#f92672">));</span>
<span style="color:#f92672">}</span>
</code></pre></div></div>
<ul>
<li>Beide periodes hebben start- en einddatum ingevuld, en periodes overlappen niet.</li>
</ul>
<div class="devselect">
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kt" data-lang="kt"><span style="color:#75af00">@Test</span>
<span style="color:#00a8c8">fun</span> <span style="color:#75af00">`Gegeven niet overlappende periodes Wanneer overlaptMet Dan is false`</span><span style="color:#111">()</span> <span style="color:#111">{</span>
    <span style="color:#00a8c8">val</span> <span style="color:#111">jandec19</span> <span style="color:#111">=</span> <span style="color:#111">Periode</span><span style="color:#111">(</span><span style="color:#111">LocalDate</span><span style="color:#111">.</span><span style="color:#111">of</span><span style="color:#111">(</span><span style="color:#ae81ff">2019</span><span style="color:#111">,</span> <span style="color:#ae81ff">1</span><span style="color:#111">,</span> <span style="color:#ae81ff">1</span><span style="color:#111">),</span> 
        <span style="color:#111">LocalDate</span><span style="color:#111">.</span><span style="color:#111">of</span><span style="color:#111">(</span><span style="color:#ae81ff">2019</span><span style="color:#111">,</span> <span style="color:#ae81ff">12</span><span style="color:#111">,</span> <span style="color:#ae81ff">31</span><span style="color:#111">))</span>
    <span style="color:#00a8c8">val</span> <span style="color:#111">maartnov20</span> <span style="color:#111">=</span> <span style="color:#111">Periode</span><span style="color:#111">(</span><span style="color:#111">LocalDate</span><span style="color:#111">.</span><span style="color:#111">of</span><span style="color:#111">(</span><span style="color:#ae81ff">2020</span><span style="color:#111">,</span> <span style="color:#ae81ff">3</span><span style="color:#111">,</span> <span style="color:#ae81ff">1</span><span style="color:#111">),</span> 
        <span style="color:#111">LocalDate</span><span style="color:#111">.</span><span style="color:#111">of</span><span style="color:#111">(</span><span style="color:#ae81ff">2020</span><span style="color:#111">,</span> <span style="color:#ae81ff">11</span><span style="color:#111">,</span> <span style="color:#ae81ff">31</span><span style="color:#111">))</span>

    <span style="color:#111">assertFalse</span> <span style="color:#111">{</span> <span style="color:#111">jandec19</span><span style="color:#111">.</span><span style="color:#111">overlaptMet</span><span style="color:#111">(</span><span style="color:#111">maartnov20</span><span style="color:#111">)</span> <span style="color:#111">}</span>
<span style="color:#111">}</span>
</code></pre></div><div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75af00">@Test</span>
<span style="color:#00a8c8">public</span> <span style="color:#00a8c8">void</span> <span style="color:#75af00">gegevenNietOverlappendePeriodes_WanneerOverlaptMet_DanIsFalse</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
    <span style="color:#111">var</span> <span style="color:#111">jandec19</span> <span style="color:#f92672">=</span> <span style="color:#00a8c8">new</span> <span style="color:#111">Periode</span><span style="color:#f92672">(</span><span style="color:#00a8c8">new</span> <span style="color:#111">Date</span><span style="color:#f92672">(</span><span style="color:#111">2019</span><span style="color:#f92672">,</span> <span style="color:#111">01</span><span style="color:#f92672">,</span> <span style="color:#111">01</span><span style="color:#f92672">),</span> 
            <span style="color:#00a8c8">new</span> <span style="color:#111">Date</span><span style="color:#f92672">(</span><span style="color:#111">2019</span><span style="color:#f92672">,</span> <span style="color:#111">12</span><span style="color:#f92672">,</span> <span style="color:#111">31</span><span style="color:#f92672">));</span>
    <span style="color:#111">var</span> <span style="color:#111">maartnov20</span> <span style="color:#f92672">=</span> <span style="color:#00a8c8">new</span> <span style="color:#111">Periode</span><span style="color:#f92672">(</span><span style="color:#00a8c8">new</span> <span style="color:#111">Date</span><span style="color:#f92672">(</span><span style="color:#111">2020</span><span style="color:#f92672">,</span> <span style="color:#111">03</span><span style="color:#f92672">,</span> <span style="color:#111">01</span><span style="color:#f92672">),</span>
            <span style="color:#00a8c8">new</span> <span style="color:#111">Date</span><span style="color:#f92672">(</span><span style="color:#111">2020</span><span style="color:#f92672">,</span> <span style="color:#111">11</span><span style="color:#f92672">,</span> <span style="color:#111">31</span><span style="color:#f92672">));</span>

    <span style="color:#111">assertThat</span><span style="color:#f92672">(</span><span style="color:#111">jandec19</span><span style="color:#f92672">.</span><span style="color:#75af00">overlaptMet</span><span style="color:#f92672">(</span><span style="color:#111">maartnov20</span><span style="color:#f92672">),</span> <span style="color:#111">is</span><span style="color:#f92672">(</span><span style="color:#00a8c8">false</span><span style="color:#f92672">));</span>
<span style="color:#f92672">}</span>
</code></pre></div></div>
<ul>
<li>&hellip; Er zijn nog tal van mogelijkheden, waarvan voornamelijk de extreme gevallen belangrijk zijn om <strong>de kans op bugs te minimaliseren</strong>. Immers, gebruikers van onze <code>Periode</code> klasse kunnen onbewust <code>null</code> mee doorgeven, waardoor de methode onverwachte waardes teruggeeft.</li>
</ul>

<div class="notices note" ><p>In Kotlin is het mogelijk om een volle zin te gebruiken als functienaam met behulp van backtics. Dit wordt in de praktijk vaak gebruik in testen op voorwaarde dat je je strict houdt aan een conventie voor de naamgeving. Zoals hierboven alle testen in de vorm van <strong>Gegeven&hellip; Wanneer&hellip; Dan&hellip;</strong> geschreven zijn. Zulke testen zijn niet alleen in code makkelijker te lezen en begrijpen, maar ook in het JUnit output window. Java enthousiastelingen zullen zich moeten beperken tot camelCase of snake_case.</p>
</div>

<p>De testen compileren niet, omdat de methode <code>overlaptMet()</code> nog niet bestaat. Voordat we overschakelen naar het schrijven van de implementatie willen we eerst de testen zien ROOD kleuren, waarbij wel de bestaande code nog compileert:</p>
<div class="devselect">
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kt" data-lang="kt"><span style="color:#00a8c8">data</span> <span style="color:#00a8c8">class</span> <span style="color:#75af00">Periode</span><span style="color:#111">(</span><span style="color:#00a8c8">val</span> <span style="color:#111">startDatum</span><span style="color:#111">:</span> <span style="color:#111">LocalDate</span><span style="color:#111">,</span> <span style="color:#00a8c8">val</span> <span style="color:#111">eindDatum</span><span style="color:#111">:</span> <span style="color:#111">LocalDate</span><span style="color:#111">)</span> <span style="color:#111">{</span>
    <span style="color:#00a8c8">fun</span> <span style="color:#75af00">overlaptMet</span><span style="color:#111">(</span><span style="color:#111">anderePeriode</span><span style="color:#111">:</span> <span style="color:#111">Periode</span><span style="color:#111">):</span> <span style="color:#111">Boolean</span> <span style="color:#111">{</span>
        <span style="color:#00a8c8">throw</span> <span style="color:#111">UnsupportedOperationException</span><span style="color:#111">()</span>
    <span style="color:#111">}</span>
<span style="color:#111">}</span>
</code></pre></div><div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#00a8c8">public</span> <span style="color:#00a8c8">class</span> <span style="color:#75af00">Periode</span> <span style="color:#f92672">{</span>
    <span style="color:#00a8c8">private</span> <span style="color:#111">Date</span> <span style="color:#111">startDatum</span><span style="color:#f92672">;</span>
    <span style="color:#00a8c8">private</span> <span style="color:#111">Date</span> <span style="color:#111">eindDatum</span><span style="color:#f92672">;</span> 
    <span style="color:#00a8c8">public</span> <span style="color:#00a8c8">boolean</span> <span style="color:#75af00">overlaptMet</span><span style="color:#f92672">(</span><span style="color:#111">Periode</span> <span style="color:#111">anderePeriode</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#00a8c8">throw</span> <span style="color:#00a8c8">new</span> <span style="color:#111">UnsupportedOperationException</span><span style="color:#f92672">();</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div></div>
<p>De aanwezigheid van het skelet van de methode zorgt er voor dat de testen compileren. De inhoud, die een <code>UnsupportedOperationException</code> gooit, dient nog aangevuld te worden in stap 2. Op dit punt falen alle testen (met hopelijk als oorzaak de voorgaande exception).</p>
<h4 id="2-schrijf-implementatie">2. Schrijf Implementatie</h4>
<p>Pas nadat er minstens 4 verschillende testen werden voorzien (standaard gevallen, edge cases, null cases, &hellip;), kan aan met een gerust hart aan de implementatie worden gewerkt:</p>
<div class="devselect">
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kt" data-lang="kt"><span style="color:#00a8c8">fun</span> <span style="color:#75af00">overlaptMet</span><span style="color:#111">(</span><span style="color:#111">ander</span><span style="color:#111">:</span> <span style="color:#111">Periode</span><span style="color:#111">):</span> <span style="color:#111">Boolean</span> <span style="color:#111">=</span>
    <span style="color:#111">startDatum</span><span style="color:#111">.</span><span style="color:#111">isAfter</span><span style="color:#111">(</span><span style="color:#111">ander</span><span style="color:#111">.</span><span style="color:#111">startDatum</span><span style="color:#111">)</span> <span style="color:#f92672">&amp;&amp;</span>
        <span style="color:#111">eindDatum</span><span style="color:#111">.</span><span style="color:#111">isBefore</span><span style="color:#111">(</span><span style="color:#111">ander</span><span style="color:#111">.</span><span style="color:#111">eindDatum</span><span style="color:#111">)</span>
<span style="color:#111">}</span>
</code></pre></div><div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#00a8c8">public</span> <span style="color:#00a8c8">boolean</span> <span style="color:#75af00">overlaptMet</span><span style="color:#f92672">(</span><span style="color:#111">Periode</span> <span style="color:#111">anderePeriode</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    <span style="color:#00a8c8">return</span> <span style="color:#111">startDatum</span><span style="color:#f92672">.</span><span style="color:#75af00">after</span><span style="color:#f92672">(</span><span style="color:#111">anderePeriode</span><span style="color:#f92672">.</span><span style="color:#75af00">startDatum</span><span style="color:#f92672">)</span> <span style="color:#f92672">&amp;&amp;</span> 
        <span style="color:#111">eindDatum</span><span style="color:#f92672">.</span><span style="color:#75af00">before</span><span style="color:#f92672">(</span><span style="color:#111">anderePeriode</span><span style="color:#f92672">.</span><span style="color:#75af00">eindDatum</span><span style="color:#f92672">);</span>
<span style="color:#f92672">}</span>
</code></pre></div></div>
<h4 id="3-voer-testen-uit">3. Voer Testen uit</h4>
<p>Deze eerste aanzet verandert de deprimerende rode kleur van minstens één test naar GROEN. Echter, lang niet alle testen zijn in orde. Voer de testen uit na elke wijziging in implementatie totdat alles in orde is. Het is mogelijk om terug naar stap 1 te gaan en extra test gevallen toe te voegen.</p>
<h4 id="4-pas-code-aan-en-herbegin">4. Pas code aan (en herbegin)</h4>
<p>De cyclus is compleet: red, green, refactor, red, green, refactor, &hellip;</p>
<p>Wat is <strong>&lsquo;refactoring&rsquo;</strong>?</p>
<blockquote>
<p>Structuur veranderen, zonder de inhoud te wijzigen.</p>
</blockquote>
<p>Als de <code>overlaptMet()</code> methode veel conditionele checks bevat is de kans groot dat bij elke groene test de inhoud stelselmatig ingewikkelder wordt, door bijvoorbeeld het veelvuldig gebruik van <code>if</code> statements. In dat geval is het verbeteren van de code, zonder de functionaliteit te wijzigen, een refactor stap. Na elke refactor stap verifiëer je de wijziging door middel van de testen.</p>
<p>Voel jij je veilig genoeg om grote wijzigingen door te voeren zonder te kunnen vertrouwen op een vangnet van testen? Wij als docenten alvast niet.</p>
<h2 id="unit-testing-basics">Unit Testing Basics</h2>
<h3 id="wat-is-unit-testing">Wat is Unit Testing</h3>
<p>Unit testen zijn stukjes code die productie code verifiëren op verschillende niveau&rsquo;s. Het resultaat van een test is GROEN (geslaagd) of ROOD (gefaald met een bepaalde reden). Een collectie van testen geeft ontwikkelaars het zelfvertrouwen om stukken van de applicatie te wijzigen met de zekerheid dat de aanwezige testen rapporteren wat nog werkt, en wat niet. Het uitvoeren van deze testen gebeurt meestal in een IDE zoals IntelliJ voor Java, of Visual Studio voor C#, zoals deze screenshot:</p>
<p><figure>
	<a href="../img/nunit.jpg" data-featherlight="image">
		<img src="../img/nunit.jpg"   title="De visuele output van NUnit in C#">
	</a>
	
		<figcaption>De visuele output van NUnit in C#</figcaption>
	
</figure>
</p>
<p>Elke validatieregel wordt apart opgelijst in één test. Als de <code>validate()</code> methode 4 regels test, zijn er minstens 4 testen geimplementeerd. In de praktijk is dat meestal meer omdat <strong>edge cases</strong> - uitzonderingsgevallen zoals <code>null</code> checks - ook aanzien worden als een apart testgeval.</p>
<h4 id="eigenschappen-van-een-goede-test">Eigenschappen van een goede test</h4>
<p>Elke unit test is <strong>F.I.R.S.T.</strong>:</p>
<ol>
<li><strong>Fast</strong>. Elk nieuw stukje functionaliteit vereist nieuwe testen, waarbij de bestaande testen ook worden uitgevoerd. In de praktijk zijn er duizenden testen die per compile worden overlopen. Als elke test één seconde duurt, wordt dit wel erg lang wachten&hellip;</li>
<li><strong>Isolated.</strong> Elke test bevat zijn eigen test scenario dat géén invloed heeft op een andere test. Vermijd ten allen tijden het gebruik van het keyword <code>static</code>, en kuis tijdelijk aangemaakte data op, om te vermijden dat andere testen worden beïnvloed.</li>
<li><strong>Repeatable</strong>. Elke test dient hetzelfde resultaat te tonen, of die nu éénmalig wordt uitgevoerd, of honderden keren achter elkaar. State kan hier typisch roet in het eten gooien.</li>
<li><strong>Self-Validating</strong>. Geen manuele inspectie is vereist om te controleren wat de status van de test is. Een falende foutboodschap is een duidelijke foutboodschap.</li>
<li><strong>Thorough</strong>. Testen moeten alle scenarios dekken: denk terug aan <em>edge cases</em>, randgevallen, het gebruik van <code>null</code>, het opvangen van mogelijke <code>Exception</code>s, &hellip;</li>
</ol>
<h3 id="het-raamwerk-van-een-test">Het Raamwerk van een test</h3>
<h4 id="test-libraries-bestaande-uit-twee-componenten">Test Libraries bestaande uit twee componenten</h4>
<p>Een test framework, zoals JUnit voor Java, MSUnit/NUnit voor C#, of Jasmine voor Javascript, bevat twee delen:</p>
<h5 id="1-het-test-harnas">1. Het Test Harnas</h5>
<p>Een &lsquo;harnas&rsquo; is het concept waar alle testen aan worden opgehangen. Het harnas identificeert en verzamelt testen, en het harnas stelt het mogelijk om bepaalde of alle testen uit te voeren. De ingebouwde Test UI in IntelliJ fungeert hier als visueel harnas. Elke test methode, een <code>public void</code> methode geannoteerd met <code>@Test</code>, wordt herkent als mogelijke test. Bovenstaande screenshot van NUnit in C# is een visuele weergave van de resultaten, verzameld door dit systeem.</p>
<p>Gradle en het JUnit harnas verzamelen data van testen in de vorm van HTML rapporten.</p>
<h5 id="2-het-assertion-framework">2. Het Assertion Framework</h5>
<p>Naast het harnas, die zorgt voor het uitvoeren van testen, hebben we ook een <em>verificatie framework</em> nodig, dat fouten genereert wanneer nodig, om te bepalen of een test al dan niet geslaagd is. Dit gebeurt typisch met <strong>assertions</strong>, die vereisten dat een argument een bepaalde waarde heeft. Is dit niet het geval, wordt er een <code>AssertionError</code> exception gegooid, die door het harnas herkent wordt, met als resultaat een falende test.</p>
<p>Assertions zijn er in alle kleuren en gewichten, waarbij in de oefeningen de statische methode <code>assertThat()</code> wordt gebruikt, die leeft in <code> org.hamcrest.MatcherAssert</code>. Hamcrest is een plugin library die ons in staat stelt om een <em>fluent API</em> te gebruiken in plaats van moeilijk leesbare assertions:</p>
<div class="devselect">
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kt" data-lang="kt"><span style="color:#00a8c8">import</span> <span style="color:#111">org.hamcrest.CoreMatchers.`is`</span> <span style="color:#00a8c8">as</span> <span style="color:#111">Is</span>
<span style="color:#75af00">@Test</span>
<span style="color:#00a8c8">fun</span> <span style="color:#75af00">`test with default assertions`</span><span style="color:#111">()</span> <span style="color:#111">{</span>
    <span style="color:#00a8c8">val</span> <span style="color:#111">result</span> <span style="color:#111">=</span> <span style="color:#111">doStuff</span><span style="color:#111">()</span>
    <span style="color:#111">AssertEquals</span><span style="color:#111">(</span><span style="color:#111">result</span><span style="color:#111">,</span> <span style="color:#ae81ff">3</span><span style="color:#111">)</span>    <span style="color:#75715e">// arg1: expected, arg2: actual
</span><span style="color:#75715e"></span><span style="color:#111">}</span>
<span style="color:#75af00">@Test</span>
<span style="color:#00a8c8">fun</span> <span style="color:#75af00">`test with hamcrest matchers`</span><span style="color:#111">()</span> <span style="color:#111">{</span>
    <span style="color:#00a8c8">val</span> <span style="color:#111">result</span> <span style="color:#111">=</span> <span style="color:#111">doStuff</span><span style="color:#111">()</span>
    <span style="color:#111">assertThat</span><span style="color:#111">(</span><span style="color:#111">result</span><span style="color:#111">,</span> <span style="color:#111">Is</span><span style="color:#111">(</span><span style="color:#ae81ff">3</span><span style="color:#111">))</span>
<span style="color:#111">}</span>
</code></pre></div><div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75af00">@Test</span>
<span style="color:#00a8c8">public</span> <span style="color:#00a8c8">void</span> <span style="color:#75af00">testWithDefaultAssertions</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
    <span style="color:#111">var</span> <span style="color:#111">result</span> <span style="color:#f92672">=</span> <span style="color:#111">doStuff</span><span style="color:#f92672">();</span>
    <span style="color:#111">AssertEquals</span><span style="color:#f92672">(</span><span style="color:#111">result</span><span style="color:#f92672">,</span> <span style="color:#111">3</span><span style="color:#f92672">);</span>    <span style="color:#75715e">// arg1: expected, arg2: actual
</span><span style="color:#75715e"></span><span style="color:#f92672">}</span>
<span style="color:#75af00">@Test</span>
<span style="color:#00a8c8">public</span> <span style="color:#00a8c8">void</span> <span style="color:#75af00">testWithHamcrestMatchers</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
    <span style="color:#111">var</span> <span style="color:#111">result</span> <span style="color:#f92672">=</span> <span style="color:#111">doStuff</span><span style="color:#f92672">();</span>
    <span style="color:#111">assertThat</span><span style="color:#f92672">(</span><span style="color:#111">result</span><span style="color:#f92672">,</span> <span style="color:#111">is</span><span style="color:#f92672">(</span><span style="color:#111">3</span><span style="color:#f92672">));</span>
<span style="color:#f92672">}</span>
</code></pre></div></div>
<p>Het tweede voorbeeld leest als een vloeiende zin, terwijl de eerste <code>AssertEquals()</code> vereist dat als eerste argument de expected value wordt meegegeven - dit is vaak het omgekeerde van wat wij verwachten!</p>
<p><a href="http://hamcrest.org/JavaHamcrest/javadoc/">HamCrest Matchers API Documentation</a></p>
<p>Een populair alternatief voor HamCrest is bijvoorbeeld <a href="https://joel-costigliola.github.io/assertj/assertj-core-quick-start.html">AssertJ</a>&mdash;en voor Kotlin-only code is <a href="https://mockk.io/">MockK</a> de betere keuze. De keuze is aan jou: alle frameworks bieden ongeveer dezelfde fluent API aan met ongeveer dezelfde features.</p>

<div class="notices note" ><p>Merk op dat in Kotlin <code>is</code> een reserved keyword is. Oplossing 1: gebruik backticks. Oplossing 2: import als uppercase <code>Is</code> met behulp van <code> import org.hamcrest.CoreMatchers.</code>`is`<code> as Is</code> (enkele backtick). Opossing 3: Gebruik een Kotlin-idiomatic assertion framework zoals <a href="https://mockk.io/">MockK</a>. Zie <a href="../tdd/in-de-praktijk">TDD in de praktijk</a> voor meer informatie.</p>
</div>

<h4 id="arrange-act-assert">Arrange, Act, Assert</h4>
<p>De body van een test bestaat typisch uit drie delen:</p>
<div class="devselect">
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kt" data-lang="kt"><span style="color:#75af00">@Test</span>
<span style="color:#00a8c8">fun</span> <span style="color:#75af00">`Given arranged When acting Then some expected result`</span><span style="color:#111">()</span> <span style="color:#111">{</span>
    <span style="color:#75715e">// 1. Arrange 
</span><span style="color:#75715e"></span>    <span style="color:#00a8c8">val</span> <span style="color:#111">instance</span> <span style="color:#111">=</span> <span style="color:#111">ClassToTest</span><span style="color:#111">(</span><span style="color:#111">arg1</span><span style="color:#111">,</span> <span style="color:#111">arg2</span><span style="color:#111">)</span>

    <span style="color:#75715e">// 2. Act
</span><span style="color:#75715e"></span>    <span style="color:#00a8c8">val</span> <span style="color:#111">result</span> <span style="color:#111">=</span> <span style="color:#111">instance</span><span style="color:#111">.</span><span style="color:#111">callStuff</span><span style="color:#111">()</span>

    <span style="color:#75715e">// 3. Assert
</span><span style="color:#75715e"></span>    <span style="color:#111">assertThat</span><span style="color:#111">(</span><span style="color:#111">result</span><span style="color:#111">,</span> <span style="color:#111">Is</span><span style="color:#111">(</span><span style="color:#00a8c8">true</span><span style="color:#111">))</span>
<span style="color:#111">}</span>
</code></pre></div><div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75af00">@Test</span>
<span style="color:#00a8c8">public</span> <span style="color:#00a8c8">void</span> <span style="color:#75af00">givenArranged_whenActing_thenSomeExpectedResult</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
    <span style="color:#75715e">// 1. Arrange 
</span><span style="color:#75715e"></span>    <span style="color:#111">var</span> <span style="color:#111">instance</span> <span style="color:#f92672">=</span> <span style="color:#00a8c8">new</span> <span style="color:#111">ClassToTest</span><span style="color:#f92672">(</span><span style="color:#111">arg1</span><span style="color:#f92672">,</span> <span style="color:#111">arg2</span><span style="color:#f92672">);</span>

    <span style="color:#75715e">// 2. Act
</span><span style="color:#75715e"></span>    <span style="color:#111">var</span> <span style="color:#111">result</span> <span style="color:#f92672">=</span> <span style="color:#111">instance</span><span style="color:#f92672">.</span><span style="color:#75af00">callStuff</span><span style="color:#f92672">();</span>

    <span style="color:#75715e">// 3. Assert
</span><span style="color:#75715e"></span>    <span style="color:#111">assertThat</span><span style="color:#f92672">(</span><span style="color:#111">result</span><span style="color:#f92672">,</span> <span style="color:#111">is</span><span style="color:#f92672">(</span><span style="color:#00a8c8">true</span><span style="color:#f92672">));</span>
<span style="color:#f92672">}</span>
</code></pre></div></div>
<ol>
<li><strong>Arrange</strong>. Het klaarzetten van data, nodig om te testen, zoals een instantie van een klasse die wordt getest, met nodige parameters/DB waardes/&hellip;</li>
<li><strong>Act</strong>. Het uitvoeren van de methode die wordt getest, en opvangen van het resultaat.</li>
<li><strong>Assert</strong>. Het verifiëren van het resultaat van de methode.</li>
</ol>
<h4 id="setup-execute-teardown">Setup, Execute, Teardown</h4>
<p>Wanneer de <strong>Arrange</strong> stap dezelfde is voor een serie van testen, kunnen we dit veralgemenen naar een <code>@Before</code> methode, die voor het uitvoeren van bepaalde of alle testen wordt uitgevoerd. Op dezelfde manier kan data worden opgekuist na elke test met een <code>@After</code> methode - dit noemt men de <em>teardown</em> stap.</p>
<p>JUnit 4 en JUnit 5 verschillen hierin op niveau van gebruik. Vanaf JUnit 5 werkt men met <code>@BeforeEach</code>/<code>@BeforeAll</code>. Raadpleeg <a href="https://junit.org/junit5/docs/current/user-guide/">de documentatie</a> voor meer informatie over het verschil tussen each/all en tussen v4/v5. Voorbeelden van JUnit 5 testen zijn terug te vinden in de <a href="../extra/sessy">SESsy Library applicatie</a>.</p>
<h3 id="soorten-van-testen">Soorten van Testen</h3>
<p>Er zijn drie grote types van testen:</p>
<p><figure>
	<a href="../img/testniveaus.jpg" data-featherlight="image">
		<img src="../img/testniveaus.jpg"   title="De drie soorten van testen.">
	</a>
	
		<figcaption>De drie soorten van testen.</figcaption>
	
</figure>
</p>
<h4 id="1-unit-testing-groen">1. Unit Testing (GROEN)</h4>
<p>Een unit test test zaken op <em>individueel niveau</em>, per klasse dus. De methodes van de <code>Periode</code> klasse testen zijn unit testen: er zijn geen andere klasses mee gemoeid. De meeste testen zijn unit testen. Hoe kleiner het blokje op bovenstaande figuur, hoe beter de <strong>F.I.R.S.T. principes</strong> kunnen nageleefd worden. Immers, hoe meer systemen opgezet moeten worden voordat het assertion framework zijn ding kan doen, hoe meer tijd verloren, en hoe meer tijd de test in totaal nodig heeft om zijn resultaat te verwerken.</p>
<h4 id="2-integration-testing-oranje">2. Integration Testing (ORANJE)</h4>
<p>Een integratie test test het <em>integratie</em> pad tussen twee verschillende klasses. Hier ligt de nadruk op <em>interactie</em> in plaats van op individuele functionaliteit, zoals bij de unit test. We willen bijvoorbeeld controleren of een bepaalde service wel iets wegschrijft naar de database, maar het schrijven zelf is op unit niveau bij de database reeds getest. Waar wij nu interesse in hebben, is de interactie tussen service en database, niet de functionaliteit van de database.</p>
<p>Typische eigenschappen van integration testen:</p>
<ul>
<li>Test geïntegreerd met externen. (db, webservice, &hellip;)</li>
<li>Test integratie twee verschillende lagen.</li>
<li>Trager dan unit tests.</li>
<li>Minder test cases.</li>
</ul>
<h5 id="test-doubles">Test Doubles</h5>
<p>Stel dat we een <code>Service</code> en een <code>Repository</code> klasse hebben gemaakt, waarvan de tweede gegevens wegschrijft naar een database. Als we de eerste klasse willen testen, willen we niet weer een verbinding opstellen, omdat dit te traag is (1), én omdat dit al getest is (2):</p>
<div class="devselect">
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kt" data-lang="kt"><span style="color:#00a8c8">class</span> <span style="color:#75af00">Repository</span><span style="color:#111">()</span> <span style="color:#111">{</span>
    <span style="color:#00a8c8">fun</span> <span style="color:#75af00">save</span><span style="color:#111">(</span><span style="color:#111">c</span><span style="color:#111">:</span> <span style="color:#111">Customer</span><span style="color:#111">)</span> <span style="color:#111">{</span>
        <span style="color:#75715e">// insert into...
</span><span style="color:#75715e"></span>    <span style="color:#111">}</span>
<span style="color:#111">}</span>
<span style="color:#00a8c8">class</span> <span style="color:#75af00">Service</span><span style="color:#111">(</span><span style="color:#00a8c8">val</span> <span style="color:#111">repository</span><span style="color:#111">:</span> <span style="color:#111">Repository</span><span style="color:#111">)</span> <span style="color:#111">{</span>
    <span style="color:#00a8c8">fun</span> <span style="color:#75af00">updateCustomerWallet</span><span style="color:#111">(</span><span style="color:#111">c</span><span style="color:#111">:</span> <span style="color:#111">Customer</span><span style="color:#111">,</span> <span style="color:#111">balance</span><span style="color:#111">:</span> <span style="color:#111">double</span><span style="color:#111">)</span> <span style="color:#111">{</span>
        <span style="color:#111">c</span><span style="color:#111">.</span><span style="color:#111">balance</span> <span style="color:#111">=</span> <span style="color:#111">balance</span>
        <span style="color:#111">repository</span><span style="color:#111">.</span><span style="color:#111">save</span><span style="color:#111">(</span><span style="color:#111">c</span><span style="color:#111">)</span>
    <span style="color:#111">}</span>
<span style="color:#111">}</span>
</code></pre></div><div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#00a8c8">public</span> <span style="color:#00a8c8">class</span> <span style="color:#75af00">Repository</span> <span style="color:#f92672">{</span>
    <span style="color:#00a8c8">public</span> <span style="color:#00a8c8">void</span> <span style="color:#75af00">save</span><span style="color:#f92672">(</span><span style="color:#111">Customer</span> <span style="color:#111">c</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#75715e">// insert into ... 
</span><span style="color:#75715e"></span>    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
<span style="color:#00a8c8">public</span> <span style="color:#00a8c8">class</span> <span style="color:#75af00">Service</span> <span style="color:#f92672">{</span>
    <span style="color:#00a8c8">private</span> <span style="color:#111">Repository</span> <span style="color:#111">repository</span><span style="color:#f92672">;</span>

    <span style="color:#00a8c8">public</span> <span style="color:#00a8c8">void</span> <span style="color:#75af00">updateCustomerWallet</span><span style="color:#f92672">(</span><span style="color:#111">Customer</span> <span style="color:#111">c</span><span style="color:#f92672">,</span> <span style="color:#00a8c8">double</span> <span style="color:#111">balance</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#111">c</span><span style="color:#f92672">.</span><span style="color:#75af00">setBalance</span><span style="color:#f92672">(</span><span style="color:#111">balance</span><span style="color:#f92672">);</span>
        <span style="color:#111">repository</span><span style="color:#f92672">.</span><span style="color:#75af00">save</span><span style="color:#f92672">(</span><span style="color:#111">c</span><span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div></div>
<p>Hoe testen we de <code>updateCustomerWallet()</code> methode, zonder de effectieve implementatie van <code>save()</code> te moeten gebruiken? Door middel van <em>test doubles</em>.</p>
<p><figure>
	<a href="../img/testdouble.jpg" data-featherlight="image">
		<img src="../img/testdouble.jpg"   title="I&#39;ll Be Back.">
	</a>
	
		<figcaption>I&#39;ll Be Back.</figcaption>
	
</figure>
</p>
<p>Zoals Arnie in zijn films bij gevaarlijke scenes een stuntman lookalike gebruikt, zo gaan wij in onze code een <code>Repository</code> lookalike gebruiken, zodat de <code>Service</code> dénkt dat hij <code>save()</code> aanroept, terwijl dit in werkelijkheid niet zo is. Daarvoor moet de repository een interface zijn. We passen in principe een design pattern toe, waarbij in de service een repository instantie wordt geïnjecteerd:</p>
<div class="devselect">
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kt" data-lang="kt"><span style="color:#00a8c8">interface</span> <span style="color:#75af00">Repository</span> <span style="color:#111">{</span>
    <span style="color:#00a8c8">fun</span> <span style="color:#75af00">save</span><span style="color:#111">(</span><span style="color:#111">c</span><span style="color:#111">:</span> <span style="color:#111">Customer</span><span style="color:#111">)</span>
<span style="color:#111">}</span>
<span style="color:#00a8c8">class</span> <span style="color:#75af00">RepositoryDBImpl</span> <span style="color:#111">:</span> <span style="color:#111">Repository</span> <span style="color:#111">{</span>
    <span style="color:#00a8c8">override</span> <span style="color:#00a8c8">fun</span> <span style="color:#75af00">save</span><span style="color:#111">(</span><span style="color:#111">c</span><span style="color:#111">:</span> <span style="color:#111">Cusomter</span><span style="color:#111">)</span> <span style="color:#111">{</span>
        <span style="color:#75715e">// insert into...
</span><span style="color:#75715e"></span>    <span style="color:#111">}</span>
<span style="color:#111">}</span>
<span style="color:#00a8c8">class</span> <span style="color:#75af00">RepositoryForTesting</span> <span style="color:#111">:</span> <span style="color:#111">Repository</span> <span style="color:#111">{</span>
    <span style="color:#00a8c8">override</span> <span style="color:#00a8c8">fun</span> <span style="color:#75af00">save</span><span style="color:#111">(</span><span style="color:#111">c</span><span style="color:#111">:</span> <span style="color:#111">Customer</span><span style="color:#111">)</span> <span style="color:#111">{</span>
        <span style="color:#75715e">// do nothing!
</span><span style="color:#75715e"></span>    <span style="color:#111">}</span>
<span style="color:#111">}</span>
<span style="color:#00a8c8">class</span> <span style="color:#75af00">Service</span><span style="color:#111">(</span><span style="color:#00a8c8">val</span> <span style="color:#111">repository</span><span style="color:#111">:</span> <span style="color:#111">Repository</span><span style="color:#111">)</span>
</code></pre></div><div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#00a8c8">public</span> <span style="color:#00a8c8">interface</span> <span style="color:#75af00">Repository</span> <span style="color:#f92672">{</span>
    <span style="color:#00a8c8">void</span> <span style="color:#75af00">save</span><span style="color:#f92672">(</span><span style="color:#111">Customer</span> <span style="color:#111">c</span><span style="color:#f92672">);</span>
<span style="color:#f92672">}</span>
<span style="color:#00a8c8">public</span> <span style="color:#00a8c8">class</span> <span style="color:#75af00">RepositoryDBImpl</span> <span style="color:#00a8c8">implements</span> <span style="color:#111">Repository</span> <span style="color:#f92672">{</span>
    <span style="color:#75af00">@Override</span>
    <span style="color:#00a8c8">void</span> <span style="color:#75af00">save</span><span style="color:#f92672">(</span><span style="color:#111">Customer</span> <span style="color:#111">c</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#75715e">// insert into...
</span><span style="color:#75715e"></span>    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
<span style="color:#00a8c8">public</span> <span style="color:#00a8c8">class</span> <span style="color:#75af00">RepositoryForTesting</span> <span style="color:#00a8c8">implements</span> <span style="color:#111">Repository</span> <span style="color:#f92672">{</span>
    <span style="color:#75af00">@Override</span>
    <span style="color:#00a8c8">public</span> <span style="color:#00a8c8">void</span> <span style="color:#75af00">save</span><span style="color:#f92672">(</span><span style="color:#111">Customer</span> <span style="color:#111">c</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#75715e">// do nothing!
</span><span style="color:#75715e"></span>    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
<span style="color:#00a8c8">public</span> <span style="color:#00a8c8">class</span> <span style="color:#75af00">Service</span> <span style="color:#f92672">{</span>
    <span style="color:#00a8c8">private</span> <span style="color:#111">Repository</span> <span style="color:#111">repository</span><span style="color:#f92672">;</span>
    <span style="color:#00a8c8">public</span> <span style="color:#75af00">Service</span><span style="color:#f92672">(</span><span style="color:#111">Repository</span> <span style="color:#111">r</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#00a8c8">this</span><span style="color:#f92672">.</span><span style="color:#75af00">repository</span> <span style="color:#f92672">=</span> <span style="color:#111">r</span><span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div></div>
<p>In de test wordt een instantie van <code>RepositoryForTesting</code> in service gebruikt in plaats van de effectieve <code>RepositoryDBImpl</code>. De test klasse <em>gedraagt</em> zich als een <code>Repository</code>, omdat deze de betreffende interface implementeert. De <code>Service</code> klasse weet niet welke implementatie van de interface binnen komt: daar kan bij het integration testing handig gebruk van worden gemaakt.</p>
<p>Een werkend voorbeeld hiervan is terug te vinden in de <a href="../extra/sessy">SESsy library applicatie</a>.</p>
<h4 id="3-end-to-end-testing-rood">3. End-To-End Testing (ROOD)</h4>
<p>Een laatste groep van testen genaamd <em>end-to-end</em> testen, ofwel <strong>scenario testen</strong>, testen de héle applicatie, van UI tot DB. Voor een webapplicatie betekent dit het simuleren van de acties van de gebruiker, door op knoppen te klikken en te navigeren doorheen de applicatie, waarbij bepaalde verwachtingen worden afgetoetst. Bijvoorbeeld, klik op &lsquo;voeg toe aan winkelmandje&rsquo;, ga naar &lsquo;winkelmandje&rsquo;, controleer of het item effectief is toegevoegd.</p>
<p>Typische eigenschappen van end-to-end testen:</p>
<ul>
<li>Test hele applicatie!</li>
<li>Niet alle limieten.</li>
<li>Traag, moeilijker onderhoudbaar.</li>
<li>Test integratie van alle lagen.</li>
</ul>
<p>Een werkend voorbeeld hiervan is terug te vinden in de <a href="../extra/sessy">SESsy library applicatie</a>.</p>
<p>De SESsy applicatie maakt gebruik van <strong>WebDriver</strong>, een interface die <strong>Selenium</strong> aanstuurt die browsers automatiseert. Op die manier kan men eenvoudig commando&rsquo;s doorsturen zoals surf naar daar, klik hier op, wacht x seconden, verifieer dat hier dat staat, &hellip; Dit is één test scenario in totaal.</p>
<p><figure>
	<a href="../img/teaching/ses/selenium.png" data-featherlight="image">
		<img src="../img/teaching/ses/selenium.png"  >
	</a>
	
</figure>
</p>
<p>In plaats van dit in (Java) code te schrijven, is het echter ook mogelijk om de <a href="https://selenium.dev/selenium-ide/">Selenium IDE</a> extentie voor Google Chrome of <a href="https://addons.mozilla.org/en-US/firefox/addon/selenium-ide/">Mozilla Firefox</a> te gebruiken. Deze browser extentie laat recorden in de browser zelf toe, en vergemakkelijkt het gebruik (er is geen nood meer aan het vanbuiten kennen van zulke commando&rsquo;s). Dit wordt in de praktijk vaak gebruikt door software analisten of testers die niet de technische kennis hebben om te programmeren, maar toch deel zijn van het ontwikkelteam.</p>
<p>Recente versies van de Selenium IDE plugin bewaren scenario&rsquo;s in <code>.side</code> bestanden, wat een JSON-notatie is. Oudere versies bewaren commando&rsquo;s in het <code>.html</code> formaat. deze bestanden bevatten een lijst van je opgenomen records:</p>
<pre><code>  &quot;tests&quot;: [{
    &quot;id&quot;: &quot;73bc78d5-1ca2-44c4-9ad2-6ccfe7cba5fe&quot;,
    &quot;name&quot;: &quot;bla&quot;,
    &quot;commands&quot;: [{
      &quot;id&quot;: &quot;f192c93d-064a-4298-8d84-a44fd617622b&quot;,
      &quot;comment&quot;: &quot;&quot;,
      &quot;command&quot;: &quot;open&quot;,
      &quot;target&quot;: &quot;/mattersof/workshops&quot;,
      &quot;targets&quot;: [],
      &quot;value&quot;: &quot;&quot;
    }, {
      &quot;id&quot;: &quot;b94bd35b-0fc0-4ede-9b47-7e24d78126e8&quot;,
      &quot;comment&quot;: &quot;&quot;,
      &quot;command&quot;: &quot;setWindowSize&quot;,
      &quot;target&quot;: &quot;1365x691&quot;,
      &quot;targets&quot;: [],
      &quot;value&quot;: &quot;&quot;
    }, {
        ...
</code></pre>
<div class="notices note" ><p>Er zijn moderne alternatieven voor Webdriver-based Java testen. De front-end van de SESsy library werkt met Vue.js, en dit kan je makkelijk testen met behulp van <a href="https://webdriver.io/">https://webdriver.io/</a> in JavaScript. Een voorbeeldje van zo&rsquo;n geautomatiseerde test staat op de front page. WebdriverIO integreert ook met ChromeDevTools, waardoor je kan doen alsof je met een smartphone surft naar een pagina: <code>browser.emulateDevice('iPhone X')</code>.</p>
</div>

<h2 id="a-nameoefalabo-oefeningen"><a name="oef"></a>Labo oefeningen</h2>
<p>Clone of fork het <i class='fab fa-github'></i> GitHub project <a href="https://github.com/KULeuven-Diepenbeek/ses-tdd-exercise-1-template">https://github.com/KULeuven-Diepenbeek/ses-tdd-exercise-1-template</a></p>
<h3 id="opgave-1">Opgave 1</h3>
<p>De Artisanale Bakkers Associatie vertrouwt op uw technische bekwaamheid om hun probleem op te lossen.
Er wordt veel Hasseltse <a href="https://en.wikipedia.org/wiki/Speculaas">Speculaas</a> gebakken, maar niemand weet
precies wat de <strong>beste</strong> Speculaas is. Schrijf een methode die <em>speculaas</em> beoordeelt op basis van de ingrediënten.
De methode, in de klasse <code>Speculaas</code>, zou er zo uit moeten zien:</p>
<div class="devselect">
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kt" data-lang="kt">    <span style="color:#00a8c8">fun</span> <span style="color:#75af00">beoordeel</span><span style="color:#111">():</span> <span style="color:#111">Int</span> <span style="color:#111">{</span>
        <span style="color:#75715e">// TODO ...
</span><span style="color:#75715e"></span>    <span style="color:#111">}</span>
</code></pre></div><div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">    <span style="color:#00a8c8">public</span> <span style="color:#00a8c8">int</span> <span style="color:#75af00">beoordeel</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
        <span style="color:#75715e">// TODO ...
</span><span style="color:#75715e"></span>    <span style="color:#f92672">}</span>
</code></pre></div></div>
<p>De functie geeft een nummer terug - hoe hoger dit nummer, hoe beter de beoordeling en hoe gelukkiger de bakker. Een speculaas kan de volgende ingrediënten bevatten: kruiden, boter, suiker, eieren, melk, honing, bloem, zout. Elke eigenschap is een nummer dat de hoeveelheid in gram uitdrukt.</p>
<p>Het principe is simpel: hoe meer ingrediënten, hoe beter de beoordeling.</p>
<p>Kijk naar een voorbeeld test hoe de methodes te hanteren. Er zijn al enkele testen voorzien. Die kan je uitvoeren met IntelliJ door op het groen pijltje te drukken, of met Gralde: <code>./gradlew.bat test</code> (Op Unix: <code>./gradlew test</code>). Dit genereert een <strong>test rapport</strong> HTML bestand in de <code>build/test</code> map.</p>
<p>We zijn dus geïnteresseerd in <strong>edge cases</strong>. Probeer alle mogelijkheden te controleren. Denk bij het testen aan de volgende zaken:</p>
<ul>
<li>Hoe zit het met een industriële speculaas, zonder kruiden of boter?</li>
<li>Wat doet de funcite beoordeel als het argument <code>null</code> is?</li>
<li>Wat als een speculaas wordt meegegeven zonder ingrediënten?</li>
</ul>
<h3 id="opgave-2">Opgave 2</h3>
<p>Clone of fork het <i class='fab fa-github'></i> GitHub project <a href="https://github.com/KULeuven-Diepenbeek/ses-tdd-exercise-2-template">https://github.com/KULeuven-Diepenbeek/ses-tdd-exercise-2-template</a></p>
<h4 id="a-mislukte-login-pogingen">A. Mislukte login pogingen</h4>
<p>Er is een foutje geslopen in de login module, waardoor Abigail nog steeds kan inloggen, maar Jos plots niet meer. De senior programmeur in ons team heeft de bug geïdentificeerd en beweert dat het in een stukje <em>oude code</em> zit,
maar hij heeft geen tijd om dit op te lossen. Nu is het aan jou.</p>
<div class="devselect">
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kt" data-lang="kt"><span style="color:#00a8c8">import</span> <span style="color:#111">java.util.regex.Pattern;</span>
<span style="color:#00a8c8">import</span> <span style="color:#111">java.util.regex.Pattern.CASE_INSENSITIVE;</span>

<span style="color:#00a8c8">fun</span> <span style="color:#75af00">control</span><span style="color:#111">(</span><span style="color:#111">username</span><span style="color:#111">:</span> <span style="color:#111">String</span><span style="color:#111">):</span> <span style="color:#111">Boolean</span> <span style="color:#111">{</span>
    <span style="color:#00a8c8">val</span> <span style="color:#111">pattern</span> <span style="color:#111">=</span> <span style="color:#111">Pattern</span><span style="color:#111">.</span><span style="color:#111">compile</span><span style="color:#111">(</span><span style="color:#d88200">&#34;^(?=[a-z]{2})(?=.{4,26})(?=[^.]*</span><span style="color:#8045ff">\\</span><span style="color:#d88200">.?[^.]*$)(?=[^_]*_?[^_]*$)[</span><span style="color:#8045ff">\\</span><span style="color:#d88200">w.]+$&#34;</span><span style="color:#111">,</span> <span style="color:#111">CASE_INSENSITIVE</span><span style="color:#111">)</span>
    <span style="color:#00a8c8">return</span> <span style="color:#111">pattern</span><span style="color:#111">.</span><span style="color:#111">matcher</span><span style="color:#111">(</span><span style="color:#111">username</span><span style="color:#111">).</span><span style="color:#111">matches</span><span style="color:#111">()</span>
<span style="color:#111">}</span>
</code></pre></div><div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#f92672">import</span> <span style="color:#111">java.util.regex.Pattern</span><span style="color:#f92672">;</span>
<span style="color:#f92672">import static</span> <span style="color:#111">java.util.regex.Pattern.CASE_INSENSITIVE</span><span style="color:#f92672">;</span>

<span style="color:#00a8c8">public</span> <span style="color:#00a8c8">static</span> <span style="color:#00a8c8">boolean</span> <span style="color:#75af00">control</span><span style="color:#f92672">(</span><span style="color:#111">String</span> <span style="color:#111">username</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    <span style="color:#111">Pattern</span> <span style="color:#111">pattern</span> <span style="color:#f92672">=</span> <span style="color:#111">Pattern</span><span style="color:#f92672">.</span><span style="color:#75af00">compile</span><span style="color:#f92672">(</span><span style="color:#d88200">&#34;^(?=[a-z]{2})(?=.{4,26})(?=[^.]*\\.?[^.]*$)(?=[^_]*_?[^_]*$)[\\w.]+$&#34;</span><span style="color:#f92672">,</span> <span style="color:#111">CASE_INSENSITIVE</span><span style="color:#f92672">);</span>
    <span style="color:#00a8c8">return</span> <span style="color:#111">pattern</span><span style="color:#f92672">.</span><span style="color:#75af00">matcher</span><span style="color:#f92672">(</span><span style="color:#111">username</span><span style="color:#f92672">).</span><span style="color:#75af00">matches</span><span style="color:#f92672">();</span>
<span style="color:#f92672">}</span>
</code></pre></div></div>
<p>Deze functie geeft <code>true</code> terug als Abigail probeert in te loggen, en <code>false</code> als Jos probeert in te loggen. Hoe komt dit? Schrijf éérst een falende test!</p>
<h4 id="b-url-verificatie-fouten">B. URL Verificatie fouten</h4>
<p>Een tweede bug wordt gemeld: URL verificatie features werken plots niet meer. Deze methode faalt steeds, ook al zijn er reeds unit testen voorzien. Het probleem is dat <strong>HTTPS</strong> URLs met een SSL certificaat niet werken. Je onderzocht de URL verificatie code en vond de volgende verdachte regels:</p>
<div class="devselect">
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kt" data-lang="kt"><span style="color:#00a8c8">import</span> <span style="color:#111">java.util.regex.Pattern;</span>
<span style="color:#00a8c8">import</span> <span style="color:#111">java.util.regex.Pattern.CASE_INSENSITIVE;</span>

<span style="color:#00a8c8">fun</span> <span style="color:#75af00">verifyUrl</span><span style="color:#111">(</span><span style="color:#111">url</span><span style="color:#111">:</span> <span style="color:#111">String</span><span style="color:#111">):</span> <span style="color:#111">Boolean</span> <span style="color:#111">{</span>
    <span style="color:#00a8c8">val</span> <span style="color:#111">pattern</span> <span style="color:#111">=</span> <span style="color:#111">Pattern</span><span style="color:#111">.</span><span style="color:#111">compile</span><span style="color:#111">(</span><span style="color:#d88200">&#34;http:</span><span style="color:#8045ff">\\</span><span style="color:#d88200">/</span><span style="color:#8045ff">\\</span><span style="color:#d88200">/(www</span><span style="color:#8045ff">\\</span><span style="color:#d88200">.)?[-a-zA-Z0-9@:%._</span><span style="color:#8045ff">\\</span><span style="color:#d88200">+~#=]{2,256}</span><span style="color:#8045ff">\\</span><span style="color:#d88200">.[a-z]{2,6}</span><span style="color:#8045ff">\\</span><span style="color:#d88200">b([-a-zA-Z0-9@:%_</span><span style="color:#8045ff">\\</span><span style="color:#d88200">+.~#?&amp;//=]*)&#34;</span><span style="color:#111">,</span> <span style="color:#111">CASE_INSENSITIVE</span><span style="color:#111">)</span>
    <span style="color:#00a8c8">return</span> <span style="color:#111">pattern</span><span style="color:#111">.</span><span style="color:#111">matcher</span><span style="color:#111">(</span><span style="color:#111">url</span><span style="color:#111">).</span><span style="color:#111">matches</span><span style="color:#111">()</span>
<span style="color:#111">}</span>
</code></pre></div><div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#f92672">import</span> <span style="color:#111">java.util.regex.Pattern</span><span style="color:#f92672">;</span>
<span style="color:#f92672">import static</span> <span style="color:#111">java.util.regex.Pattern.CASE_INSENSITIVE</span><span style="color:#f92672">;</span>

<span style="color:#00a8c8">public</span> <span style="color:#00a8c8">static</span> <span style="color:#00a8c8">boolean</span> <span style="color:#75af00">verifyUrl</span><span style="color:#f92672">(</span><span style="color:#111">String</span> <span style="color:#111">url</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    <span style="color:#111">Pattern</span> <span style="color:#111">pattern</span> <span style="color:#f92672">=</span> <span style="color:#111">Pattern</span><span style="color:#f92672">.</span><span style="color:#75af00">compile</span><span style="color:#f92672">(</span><span style="color:#d88200">&#34;http:\\/\\/(www\\.)?[-a-zA-Z0-9@:%._\\+~#=]{2,256}\\.[a-z]{2,6}\\b([-a-zA-Z0-9@:%_\\+.~#?&amp;//=]*)&#34;</span><span style="color:#f92672">,</span> <span style="color:#111">CASE_INSENSITIVE</span><span style="color:#f92672">);</span>
    <span style="color:#00a8c8">return</span> <span style="color:#111">pattern</span><span style="color:#f92672">.</span><span style="color:#75af00">matcher</span><span style="color:#f92672">(</span><span style="color:#111">url</span><span style="color:#f92672">).</span><span style="color:#75af00">matches</span><span style="color:#f92672">();</span>
<span style="color:#f92672">}</span>
</code></pre></div></div>
<p>De code blijkt reeds <strong>unit testen</strong> te hebben, dus schrijf éérst een falende test (in <code>VerifierTests</code>).</p>
<h3 id="opgave-3">Opgave 3</h3>
<p>Werk een volledige implementatie van <code>Periode.overlaptMet()</code> uit, zoals hierboven uitgelegd.</p>
<h3 id="opgave-4">Opgave 4</h3>

<div class="notices info" ><p>Dit is een vervolgopgave van de code van <strong>Opgave 1</strong>. Werk verder op dat bestaand project, in diezelfde repository!</p>
</div>

<p>Een verkoopster werkt in een (goede) speculaasfabriek. De verkoopster wilt graag 2 EUR aanrekenen per speculaas die de fabriek produceert.
Echter, als de klant meer dan 5 stuks verkoopt, mag er een korting van 10% worden aangerekend.</p>
<div class="devselect">
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kt" data-lang="kt">    <span style="color:#00a8c8">fun</span> <span style="color:#75af00">verkoop</span><span style="color:#111">():</span> <span style="color:#111">Double</span> <span style="color:#111">{</span>
        <span style="color:#00a8c8">val</span> <span style="color:#111">gebakken</span> <span style="color:#111">=</span> <span style="color:#111">speculaasFabriek</span><span style="color:#111">.</span><span style="color:#111">bak</span><span style="color:#111">()</span>
        <span style="color:#75715e">// TODO ...
</span><span style="color:#75715e"></span>    <span style="color:#111">}</span>
</code></pre></div><div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">    <span style="color:#00a8c8">public</span> <span style="color:#00a8c8">double</span> <span style="color:#75af00">verkoop</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
        <span style="color:#111">var</span> <span style="color:#111">gebakken</span> <span style="color:#f92672">=</span> <span style="color:#111">speculaasFabriek</span><span style="color:#f92672">.</span><span style="color:#75af00">bak</span><span style="color:#f92672">();</span>
        <span style="color:#75715e">// TODO ...
</span><span style="color:#75715e"></span>    <span style="color:#f92672">}</span>
</code></pre></div></div>
<p>Je ziet aan bovenstaande code dat de speculaasfabriek instantie wordt gebruikt. We hebben dus eigenlijk <strong>geen controle</strong> op de hoeveelheid speculaas die deze fabriek produceert.</p>
<h3 id="unit-testen">Unit testen</h3>
<p>Hoe kunnen we dan toch nog testen wat we willen testen? Mogelijke scenario&rsquo;s:</p>
<ol>
<li>De fabriek produceert niets. De klant betaalt niets.</li>
<li>De fabriek produceert minder dan 5 speculaasjes. De klant betaalt per stuk, 2 EUR.</li>
<li>De fabriek produceert meer dan 5 stuks. De klant krijgt 10% korting op zijn totaal.</li>
</ol>
<h3 id="hoe-controleer-ik-het-gedrag-van-de-fabriek">Hoe controleer ik het gedrag van de fabriek?</h3>
<p>Mockito is verreweg het meest populaire Unit Test Framework dat bovenop JUnit wordt gebruikt om heel snel Test Doubles en integratietesten op te bouwen.</p>
<p><figure>
	<a href="../img/teaching/ses/mockito.png" data-featherlight="image">
		<img src="../img/teaching/ses/mockito.png"  alt="Mockito logo" >
	</a>
	
</figure>
</p>
<p>Gebruik dus hiervoor Mockito, en injecteer een <code>mock(SpeculaasFabriek.class)</code> in de verkoopster (de setter is reeds voorzien).</p>
<p>Lees op <a href="https://site.mockito.org">https://site.mockito.org</a> <strong>hoe</strong> je het framework moet gebruiken. (Volledige <a href="https://javadoc.io/doc/org.mockito/mockito-core/latest/org/mockito/Mockito.html">javadoc</a>) Denk aan de volgende zaken:</p>
<ul>
<li>Hoe include ik Mockito als een dependency in mijn project?</li>
<li>Hoe gebruik ik de API om een Test Double/mock aan te maken?</li>
<li>Hoe valideer ik verwachtingen die ik heb van deze Test Double?</li>
</ul>
<p><a href="../tdd/in-de-praktijk">Het gebruik van Mockito en MockK: een uitgewerkt voorbeeld</a>.</p>
<h3 id="opgave-5">Opgave 5</h3>
<p>Gebruik Selenium IDE om een test scenario op te nemen van de SESsy applicatie. Start deze eerst lokaal, en vertrek vanuit het localhost base address <a href="http://localhost:8080/#/">http://localhost:8080/#/</a>. Hanteer de volgende scenario&rsquo;s:</p>
<ol>
<li>Als anoniempje, zoek op &lsquo;art&rsquo;, klik op detail, klik op uitlenen. Verifieer dat er een waarschuwingsboodschap verschijnt dat je niet kan uitlenen.</li>
<li>Als slechte uitlener, zoek op &lsquo;art&rsquo;, klik op detail, klik op uitlenen. Verifieer dat er een boodschap verschijnt dat het gelukt is, en dat de knop veranderde naar &lsquo;Terugbrengen?&rsquo;. Klik op terugbrengen. Verifieer dat er een boodschap verschijnt dat het gelukt is.</li>
<li>Als anoniempje, log in (een van beide rollen). Verifieer dat login naar logout verandert. Logout. Verifieer dat logout naar login verandert.</li>
</ol>

<div class="notices info" ><p><strong>Bewaar dit scenario, opgenomen met de Selenium IDE, in bestand <em>opgave5.html</em> (of <code>.side</code> voor nieuwe versies)</strong> in de root de <a href="https://github.com/KULeuven-Diepenbeek/ses-tdd-exercise-1-template">repository van opgave 1</a>.</p>
</div>

<p>Je zal voor deze opgave dus de lokale <a href="../extra/sessy">SESsy applicatie</a> moeten starten, en de Selenium (Chromium/Firefox) plugin moeten installeren: zie hierboven.</p>
<h2 id="denkvragen">Denkvragen</h2>
<ul>
<li>Wat doe je met opgenomen test materiaal in Selenium IDE? Hoe integreeg je dit in een build systeen? Met andere woorden, hoe zorg je er voor dat deze testen automatisch draaien, telkens er iets in de code wordt gewijzigd?</li>
<li>Hoe vertaal je de Selenium IDE commando&rsquo;s naar WebDriver Java commando&rsquo;s?</li>
</ul>
<h2 id="extra-leermateriaal">Extra leermateriaal</h2>
<p>Lees de volgende artikels om een beter inzicht te krijgen in de capaciteiten van de Test-Driven benadering:</p>
<ul>
<li><a href="https://www.jamesshore.com/Agile-Book/test_driven_development.html">The Art of Agile Development: Test-Driven Development</a></li>
<li><a href="https://en.wikipedia.org/wiki/Test-driven_development">Benefits of TDD: Wikipedia</a></li>
<li><a href="https://www.jamesshore.com/Blog/Lets-Play">Let&rsquo;s Play: TDD Screencasts</a></li>
<li><a href="http://hamcrest.org/JavaHamcrest/javadoc/">HamCrest Matchers API Documentation</a></li>
<li><a href="http://martinfowler.com/articles/mocksArentStubs.html">Integration Testing: Mocks Aren&rsquo;t Stubs (Martin Fowler)</a></li>
</ul>





<footer class=" footline" >
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="../dependency-management/kotlin-gradle/" title="2.3 Kotlin Gradle projecten"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="../tdd/in-de-praktijk/" title="3.1 TDD In de praktijk" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="../js/clipboard.min.js?1686665213"></script>
    <script src="../js/perfect-scrollbar.min.js?1686665213"></script>
    <script src="../js/perfect-scrollbar.jquery.min.js?1686665213"></script>
    <script src="../js/jquery.sticky.js?1686665213"></script>
    <script src="../js/featherlight.min.js?1686665213"></script>
    <script src="../js/modernizr.custom-3.6.0.js?1686665213"></script>
    <script src="../js/learn.js?1686665213"></script>
    <script src="../js/hugo-learn.js?1686665213"></script>
    
        
            <script src="../mermaid/mermaid.js?1686665213"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    

  </body>
</html>
